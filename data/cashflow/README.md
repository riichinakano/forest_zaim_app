# 資金繰り表データフォルダ

このフォルダには、月次資金繰り表のExcelファイルを配置します。

## ファイル配置方法

### ファイル名規則

```
shikinguri_{年度}_{日付}.xlsx
```

例:
- `shikinguri_R4_20240229.xlsx` (令和4年度)
- `shikinguri_R5_20240229.xlsx` (令和5年度)
- `shikinguri_R6_20250324.xlsx` (令和6年度)

### Excelファイル形式

**シート:** 1シート目を使用

**必須項目（キーワード検索で自動検出）:**
- `前期繰越` - 前期繰越残高
- `計 (B)` - 収入合計
- `計 (C)` - 支出合計
- `差引過不足` - 差引過不足
- `翌月繰越` - 翌月繰越残高

**月次データ:** 4月〜3月の12ヶ月分

**年度の自動判定:**
- タイトル行の「令和○年度」から自動検出
- または日付から自動判定（4月始まりの年度）

## 注意事項

- **このフォルダ内のExcelファイルは`.gitignore`で除外されています**
- 内部情報を含むため、GitHubにはコミットされません
- 各環境で個別にデータファイルを配置してください

## 初期セットアップ

1. このフォルダに資金繰り表Excelファイルを配置
2. ファイル名が規則に従っているか確認
3. アプリを起動すると自動的に認識されます

```bash
streamlit run test_cashflow.py
```

## データ構造の柔軟性

このローダーは以下の特徴があります：

- **行番号固定ではなくキーワード検索** - 年度ごとに構造が変わっても対応可能
- **年度の自動判定** - ファイル名に依存せず、内容から年度を判定
- **統一フォーマットへの変換** - 全年度を同じDataFrame構造に変換

## トラブルシューティング

### データが読み込めない場合

1. Excelファイルに「前期繰越」「計 (B)」などのキーワードがあるか確認
2. 月次データが4列目以降に12ヶ月分あるか確認
3. エラーメッセージを確認してください

### 年度が正しく認識されない場合

- Excelのタイトル行に「令和○年度」が含まれているか確認
- または日付列から正しく年度を推測できるか確認
